# SQL
### PosgreSQL study

#### Проектная работа по модулю “SQL и получение данных”

Поздравляем, вы в финале обучения на курсе SQL! Осталось совсем немного: закрепить все пройденные занятия и полученные знания в финальной работе.
Для выполнения работы Вам необходимо:
 						
1.	Перейти по ссылке и ознакомиться с описанием базы данных: https://edu.postgrespro.ru/bookings.pdf
2.	Подключиться к базе данных avia по одному из следующих вариантов:
-	облачное подключение, те же настройки, что и у dvd-rental, только название базы demo, схема bookings
-	импорт sql запроса из sql файла, представленных на 2 странице описания базы
-	восстановить базу из *.backup файла по ссылке avia
3.	Оформить работу согласно “Приложения №1” в формате *.pdf или *.doc
4.	Создать запросы, позволяющие ответить на вопросы из “Приложения №2”, решения должны быть приложены в формате *.sql одним файлом.
5.	Отправить работу на проверку

Приложение №1
Итоговая работа 

1.	В работе использовался _______ тип подключения.
-	если база была развернута из *.sql или *.backup файла, необходимо приложить скриншот успешного импорта или восстановления
2.	Скриншот ER-диаграммы из DBeaver`a согласно Вашего подключения.
3.	Краткое описание БД - из каких таблиц и представлений состоит.
4.	Развернутый анализ БД - описание таблиц, логики, связей и бизнес области (частично можно взять из описания базы данных, оформленной в виде анализа базы данных). Бизнес задачи, которые можно решить, используя БД.
5.	Список SQL запросов из приложения №2 с описанием логики их выполнения.

Перелет = flight_id

Баллы за оформление:
1.	0 - облачная база, 10 - локальная база
2.	5
3.	10
4.	20
5.	15
Итого: максимум 60 баллов.
Для зачета необходимо набрать минимум 30 баллов.

Приложение №2

№	Вопрос	В решении обязательно должно быть использовано
1	В каких городах больше одного аэропорта?	

2	В каких аэропортах есть рейсы, выполняемые самолетом с максимальной дальностью перелета?	- Подзапрос
3	Вывести 10 рейсов с максимальным временем задержки вылета	- Оператор LIMIT
4	Были ли брони, по которым не были получены посадочные талоны?	- Верный тип JOIN
5	Найдите свободные места для каждого рейса, их % отношение к общему количеству мест в самолете.
Добавьте столбец с накопительным итогом - суммарное накопление количества вывезенных пассажиров из каждого аэропорта на каждый день. Т.е. в этом столбце должна отражаться накопительная сумма - сколько человек уже вылетело из данного аэропорта на этом или более ранних рейсах за день.	- Оконная функция
- Подзапросы или cte
6	Найдите процентное соотношение перелетов по типам самолетов от общего количества.	- Подзапрос
- Оператор ROUND
7	Были ли города, в которые можно  добраться бизнес - классом дешевле, чем эконом-классом в рамках перелета?	- CTE
8	Между какими городами нет прямых рейсов?	- Декартово произведение в предложении FROM
- Самостоятельно созданные представления (если облачное подключение, то без представления)
- Оператор EXCEPT
9	Вычислите расстояние между аэропортами, связанными прямыми рейсами, сравните с допустимой максимальной дальностью перелетов  в самолетах, обслуживающих эти рейсы *	- Оператор RADIANS или использование sind/cosd
- CASE 
	
* - В облачной базе координаты находятся в столбце airports_data.coordinates - работаете, как с массивом. В локальной базе координаты находятся в столбцах airports.longitude и airports.latitude.
Кратчайшее расстояние между двумя точками A и B на земной поверхности (если принять ее за сферу) определяется зависимостью:
d = arccos {sin(latitude_a)·sin(latitude_b) + cos(latitude_a)·cos(latitude_b)·cos(longitude_a - longitude_b)}, где latitude_a и latitude_b — широты, longitude_a, longitude_b — долготы данных пунктов, d — расстояние между пунктами измеряется в радианах длиной дуги большого круга земного шара.
Расстояние между пунктами, измеряемое в километрах, определяется по формуле:
L = d·R, где R = 6371 км — средний радиус земного шара.

Баллы за запросы:
1.	10
2.	15
3.	15
4.	15
5.	35
6.	25
7.	25
8.	25
9.	35
Итого: максимум 200 баллов.

Для зачета необходимо набрать минимум 130 баллов.

